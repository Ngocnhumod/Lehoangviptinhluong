<!DOCTYPE html><html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bảng chấm công & lương (14/08 → 10/09/2025)</title>
  <style>
    :root{
      --bg:#0f1115; --panel:#171a21; --panel2:#1e232d; --txt:#e8eefc; --muted:#8b93a7; --accent:#77ffd4; --bad:#ff6b6b; --good:#42d392;
      --warn:#ffd166;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font:14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 600px at 70% -10%, #1b2030 0%, transparent 60%), 
                  linear-gradient(180deg, #10131a, #0b0e13 40%), var(--bg); color:var(--txt)}
    .wrap{max-width:1100px; margin:24px auto; padding:0 16px}
    h1{font-size:22px; margin:0 0 8px}
    h2{font-size:16px; margin:14px 0 8px; color:var(--accent)}
    .card{background:linear-gradient(180deg,#151925,#0f131c); border:1px solid #21283a; border-radius:16px; padding:16px; box-shadow: 0 10px 24px rgba(0,0,0,.25)}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .row > *{flex:1 1 220px}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    input, select, button{width:100%; padding:10px 12px; border-radius:12px; border:1px solid #2a3246; background:#0f1320; color:var(--txt)}
    input::placeholder{color:#73809d}
    button{cursor:pointer; border:1px solid #2f3a54; background:linear-gradient(180deg,#1a2132,#121829)}
    button.primary{background:linear-gradient(180deg,#1e2d2a,#14221f); border-color:#265246}
    button.warn{background:linear-gradient(180deg,#2d281a,#211a12); border-color:#5a4a1b}
    table{width:100%; border-collapse:separate; border-spacing:0 10px}
    thead th{font-weight:600; font-size:12px; color:#a8b2c9; text-transform:uppercase; letter-spacing:.3px}
    tbody tr{background:#121829; border:1px solid #1e2536}
    tbody td, thead th{padding:10px 12px}
    tbody tr{border-radius:12px; overflow:hidden}
    tbody tr td:first-child{border-top-left-radius:12px; border-bottom-left-radius:12px}
    tbody tr td:last-child{border-top-right-radius:12px; border-bottom-right-radius:12px}
    .pill{display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; font-size:12px; border:1px solid #2a3246}
    .pill.ok{color:var(--good); border-color:#2f5b46; background:#0f1c18}
    .pill.bad{color:var(--bad); border-color:#5b2f2f; background:#1c0f0f}
    .pill.warn{color:#ffd166; border-color:#5b4c2f; background:#1c160f}
    .totals{display:grid; grid-template-columns: repeat(4, 1fr); gap:10px}
    .totals .box{background:#0f1320; border:1px solid #26304a; border-radius:12px; padding:12px}
    .totals .box b{font-size:18px}
    .right{display:flex; justify-content:flex-end; gap:8px}
    .muted{color:var(--muted)}
    .hr{height:1px; background:#222a3d; margin:14px 0}
    .small{font-size:12px}
    .note{font-size:12px; color:#9ab3ff}
  </style>
</head>
<body>
<div class="wrap">
  <h1>💼 Bảng chấm công & lương (14/08 → 10/09/2025)</h1>
  <div class="muted small">Quy ước mặc định: <b>công nhật 230.000đ/8h</b> → lương giờ cơ bản 28.750đ, tăng ca = 1.5× (43.125đ/giờ). Các ngày đặc biệt (29/08: giờ 30k, 09/09: OT theo 29k/h) đã ghi rõ bên dưới.</div>  <div class="hr"></div>  <div class="totals" id="totals">
    <div class="box"><div class="muted small">Tổng công chính</div><b id="sumMain">0đ</b></div>
    <div class="box"><div class="muted small">Tổng tiền tăng ca</div><b id="sumOT">0đ</b></div>
    <div class="box"><div class="muted small">Tổng cộng</div><b id="sumAll">0đ</b></div>
    <div class="box"><div class="muted small">Số ngày (ghi công)</div><b id="countDays">0</b></div>
  </div>  <h2>Nhật ký công</h2>
  <div class="card">
    <div class="row">
      <div>
        <label>Ngày</label>
        <input type="date" id="fDate" />
      </div>
      <div>
        <label>Ghi chú / Thứ tự ngày công</label>
        <input id="fNote" placeholder="VD: Ngày công 15, nửa buổi, có tăng ca…" />
      </div>
      <div>
        <label>Công chính (tiền)</label>
        <input id="fMainPay" type="number" placeholder="vd 230000" />
      </div>
      <div>
        <label>Giờ chính (tuỳ chọn)</label>
        <input id="fMainHours" type="number" step="0.01" placeholder="vd 8 hoặc 4" />
      </div>
      <div>
        <label>Tăng ca (giờ)</label>
        <input id="fOTHours" type="number" step="0.01" placeholder="vd 2.5" />
      </div>
      <div>
        <label>Tiền tăng ca</label>
        <input id="fOTPay" type="number" placeholder="vd 107813" />
      </div>
    </div>
    <div class="row" style="margin-top:8px">
      <div>
        <label>Hệ số OT</label>
        <select id="fOTFactor">
          <option value="1.5" selected>1.5× (mặc định)</option>
          <option value="1.0">1.0×</option>
          <option value="2.0">2.0×</option>
        </select>
      </div>
      <div>
        <label>Base giờ (tính OT nhanh)</label>
        <select id="fBaseHour">
          <option value="28750" selected>28.750đ/h (230k/8h)</option>
          <option value="29000">29.000đ/h</option>
          <option value="30000">30.000đ/h</option>
        </select>
      </div>
      <div class="right" style="align-items:flex-end">
        <button class="warn" id="btnCalc">Tính nhanh tiền OT từ giờ</button>
        <button class="primary" id="btnAdd">➕ Thêm dòng</button>
      </div>
    </div>
  </div>  <div style="height:10px"></div>  <div class="card">
    <div class="row">
      <div>
        <label>Lọc</label>
        <select id="filter">
          <option value="all" selected>Tất cả</option>
          <option value="ot">Chỉ ngày có tăng ca</option>
          <option value="noot">Chỉ ngày không tăng ca</option>
        </select>
      </div>
      <div>
        <label>Sắp xếp</label>
        <select id="sorter">
          <option value="dateAsc">Ngày ↑</option>
          <option value="dateDesc" selected>Ngày ↓</option>
          <option value="totalDesc">Tổng tiền ↓</option>
          <option value="totalAsc">Tổng tiền ↑</option>
        </select>
      </div>
      <div class="right" style="align-items:flex-end">
        <button id="btnExport">📄 Xuất JSON</button>
      </div>
    </div><div style="height:12px"></div>

<table>
  <thead>
    <tr>
      <th>Ngày</th>
      <th>Công chính</th>
      <th>Giờ chính</th>
      <th>Tăng ca (giờ)</th>
      <th>Tiền tăng ca</th>
      <th>Tổng ngày</th>
      <th>Ghi chú</th>
    </tr>
  </thead>
  <tbody id="tbody"></tbody>
</table>

  </div>  <p class="note">Mẹo: Nhập giờ OT + chọn Base giờ + Hệ số → bấm “Tính nhanh tiền OT từ giờ” để auto điền <b>Tiền tăng ca</b>.</p>
</div><script>
const VND = new Intl.NumberFormat('vi-VN');
const fmt = n => VND.format(Math.round(n)) + 'đ';

// Dữ liệu đã chốt cùng ck (đến 10/09/2025)
let rows = [
  // Tháng 8
  r('2025-08-14', 230000, 8, 2.5, 107813, 'Ngày công 1 – có tăng ca'),
  r('2025-08-15', 230000, 8, 0, 0, 'Ngày công 2'),
  r('2025-08-16', 230000, 8, 0, 0, 'Ngày công 3'),
  r('2025-08-18', 230000, 8, 0, 0, 'Ngày công 4'),
  r('2025-08-22', 172500, 6, 2, 86250, 'Ngày công 5 – 6h chính + OT'),
  r('2025-08-23', 230000, 8, 2.7666667, 119313, 'Ngày công 6 – OT 2h46 (làm tròn)') ,
  r('2025-08-25', 115000, 4, 0, 0, 'Ngày công 7 – nửa buổi chiều'),
  r('2025-08-26', 230000, 8, 0, 0, 'Ngày công 8'),
  r('2025-08-27', 230000, 8, 0, 0, 'Ngày công 9'),
  // 28/08 nghỉ
  // 29/08: giờ 30k + OT tính theo base 28.750đ/h (đã chốt số tiền ở sổ trước)
  r('2025-08-29', 225000, 7.5, 0.75, 32344, 'Ngày công 10 – sáng & chiều tính 30k/h; OT trưa 45 phút'),
  r('2025-08-30', 230000, 8, 0, 0, 'Ngày công 11'),

  // Tháng 9
  r('2025-09-05', 230000, 8, 0, 0, 'Ngày công 12'),
  r('2025-09-06', 230000, 8, 2.1666667, 94000, 'Ngày công 13 – OT 2h10 (chốt 94k)'),
  r('2025-09-08', 115000, 4, 0, 0, 'Ngày công 14 – nửa buổi'),
  // 09/09: OT tính theo base 29k/h, hệ số 1.5 → 108.750đ
  r('2025-09-09', 230000, 8, 2.5, 108750, 'Ngày công 15 – OT tối (base 29k/h)'),
  r('2025-09-10', 230000, 8, 0, 0, 'Ngày công 16')
];

function r(date, mainPay, mainHours, otHours, otPay, note){
  const total = (mainPay||0) + (otPay||0);
  return {date, mainPay, mainHours, otHours, otPay, total, note};
}

function render(){
  const tb = document.getElementById('tbody');
  tb.innerHTML = '';
  let list = [...rows];
  // filter
  const f = document.getElementById('filter').value;
  if(f==='ot') list = list.filter(x=> (x.otPay||0) > 0);
  if(f==='noot') list = list.filter(x=> (x.otPay||0) === 0);
  // sort
  const s = document.getElementById('sorter').value;
  if(s==='dateAsc') list.sort((a,b)=> a.date.localeCompare(b.date));
  if(s==='dateDesc') list.sort((a,b)=> b.date.localeCompare(a.date));
  if(s==='totalDesc') list.sort((a,b)=> (b.total)-(a.total));
  if(s==='totalAsc') list.sort((a,b)=> (a.total)-(b.total));

  let sumMain=0, sumOT=0;
  list.forEach(x=>{
    sumMain += x.mainPay||0; sumOT += x.otPay||0;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><b>${fmtDate(x.date)}</b></td>
      <td>${fmt(x.mainPay||0)}</td>
      <td>${x.mainHours? x.mainHours.toFixed(2).replace('.00','')+'h' : '<span class="muted">—</span>'}</td>
      <td>${x.otHours? x.otHours.toFixed(2).replace('.00','')+'h' : '<span class="muted">0</span>'}</td>
      <td>${x.otPay? fmt(x.otPay) : '<span class="muted">0đ</span>'}</td>
      <td><b>${fmt(x.total)}</b></td>
      <td class="small">${x.note||''}</td>`;
    tb.appendChild(tr);
  });
  // totals
  const allMain = rows.reduce((a,b)=>a+(b.mainPay||0),0);
  const allOT = rows.reduce((a,b)=>a+(b.otPay||0),0);
  document.getElementById('sumMain').textContent = fmt(allMain);
  document.getElementById('sumOT').textContent = fmt(allOT);
  document.getElementById('sumAll').textContent = fmt(allMain+allOT);
  document.getElementById('countDays').textContent = rows.length;
}

function fmtDate(s){
  const d = new Date(s);
  const dd = String(d.getDate()).padStart(2,'0');
  const mm = String(d.getMonth()+1).padStart(2,'0');
  const yy = d.getFullYear();
  return `${dd}/${mm}/${yy}`;
}

// Add new row
const btnAdd = document.getElementById('btnAdd');
btnAdd.addEventListener('click', ()=>{
  const date = document.getElementById('fDate').value;
  const note = document.getElementById('fNote').value.trim();
  const mainPay = Number(document.getElementById('fMainPay').value||0);
  const mainHours = Number(document.getElementById('fMainHours').value||0);
  const otHours = Number(document.getElementById('fOTHours').value||0);
  const otPay = Number(document.getElementById('fOTPay').value||0);
  if(!date){ alert('Nhập ngày'); return; }
  rows.push(r(date, mainPay, mainHours, otHours, otPay, note));
  render();
  // reset minimal
  document.getElementById('fNote').value='';
  document.getElementById('fMainPay').value='';
  document.getElementById('fMainHours').value='';
  document.getElementById('fOTHours').value='';
  document.getElementById('fOTPay').value='';
});

// Quick calc OT from hours
const btnCalc = document.getElementById('btnCalc');
btnCalc.addEventListener('click', ()=>{
  const hours = Number(document.getElementById('fOTHours').value||0);
  const base = Number(document.getElementById('fBaseHour').value||28750);
  const factor = Number(document.getElementById('fOTFactor').value||1.5);
  const pay = hours * base * factor;
  document.getElementById('fOTPay').value = Math.round(pay);
});

// Export
const btnExport = document.getElementById('btnExport');
btnExport.addEventListener('click', ()=>{
  const data = JSON.stringify(rows, null, 2);
  const blob = new Blob([data], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'cham_cong_1408-1009_2025.json';
  a.click();
  URL.revokeObjectURL(url);
});

// Filters
['filter','sorter'].forEach(id=>document.getElementById(id).addEventListener('change', render));

render();
</script></body>
</html>